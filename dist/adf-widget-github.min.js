!function(){"use strict";angular.module("adf.widget.github",["adf.provider","highcharts-ng"]).value("githubApiUrl","https://api.github.com/repos/").config(["dashboardProvider",function(t){var i={templateUrl:"{widgetsPath}/github/src/view.html",reload:!0,resolve:{commits:["githubService","config",function(t,i){return i.path?t.getCommits(i.path):void 0}]},edit:{templateUrl:"{widgetsPath}/github/src/edit.html"}};t.widget("githubHistory",angular.extend({title:"Github History",description:"Display the commit history of a GitHub project as chart",controller:"githubHistoryCtrl"},i)).widget("githubAuthor",angular.extend({title:"Github Author",description:"Displays the commits per author as pie chart",controller:"githubAuthorCtrl"},i))}]),angular.module("adf.widget.github").run(["$templateCache",function(t){t.put("{widgetsPath}/github/src/edit.html",'<form role=form><div class=form-group><label for=path>Github Repository Path</label> <input type=text class=form-control id=path ng-model=config.path placeholder="Enter Path (username/reponame)"></div></form>'),t.put("{widgetsPath}/github/src/view.html",'<div><div class="alert alert-info" ng-if=!chartConfig>Please insert a repository path in the widget configuration</div><div ng-if=chartConfig><highchart id=chart1 config=chartConfig></highchart></div></div>')}]),angular.module("adf.widget.github").service("githubService",["$q","$http","githubApiUrl",function(t,i,e){return{getCommits:function(r){var o=t.defer(),a=e+r+"/commits?callback=JSON_CALLBACK";return i.jsonp(a).success(function(t){if(t&&t.meta){var i=t.meta.status;300>i?o.resolve(t.data):o.reject(t.data.message)}}).error(function(){o.reject()}),o.promise}}}]),angular.module("adf.widget.github").controller("githubHistoryCtrl",["$scope","config","commits",function(t,i,e){function r(t){var i=t.split("-");return Date.UTC(i[0],i[1]-1,i[2])}var o={};angular.forEach(e,function(t){var i=t.commit.author.date;i=i.substring(0,i.indexOf("T")),o[i]?o[i]++:o[i]=1});var a=[];angular.forEach(o,function(t,i){a.push([r(i),t])}),a.sort(function(t,i){return t[0]-i[0]}),e&&(t.chartConfig={chart:{type:"spline"},title:{text:"Github commit history"},xAxis:{type:"datetime"},yAxis:{title:{text:"Commits"},min:0},series:[{name:i.path,data:a}]})}]),angular.module("adf.widget.github").controller("githubAuthorCtrl",["$scope","config","commits",function(t,i,e){var r={};angular.forEach(e,function(t){var i=t.commit.author.name;r[i]?r[i]++:r[i]=1});var o=[];if(angular.forEach(r,function(t,i){o.push([i,t])}),o.length>0){o.sort(function(t,i){return i[1]-t[1]});var a=o[0];o[0]={name:a[0],y:a[1],sliced:!0,selected:!0}}e&&(t.chartConfig={chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1},title:{text:i.path},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,color:"#000000",connectorColor:"#000000",format:"<b>{point.name}</b>: {point.percentage:.1f} %"}}},series:[{type:"pie",name:i.path,data:o}]})}])}(window);